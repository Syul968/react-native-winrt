parameters:
  buildLogDirectory: $(Build.BinariesDirectory)\$(BuildPlatform)\$(BuildConfiguration)\BuildLogs

steps:
  - task: CmdLine@2
    displayName: Check for failure
    inputs:
      script: dir $(parameters.failureLog) /s
      failOnStderr: true

  - task: PublishBuildArtifacts@1
    displayName: Upload failure log
    condition:  failed()
    inputs:
      pathtoPublish: '${{ parameters.failureLog }}'
      artifactName: 'Failure log - $(Agent.JobName)-$(System.JobAttempt)'